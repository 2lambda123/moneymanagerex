<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Менеджер отчётов</title>
    <link href="../manual.css" rel="stylesheet" type="text/css">
    <script src="../js/get_param.js"></script>
    <script src="../js/toc.js"></script>
    <script src='http://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js'></script>
    <script src="../js/back_to_top.js"></script>
</head>
<body onload="generateTOC(document.getElementById('toc'));">
    <header>
        <nav><small><a id="go_home" href="../index.html?lang=ru">Перейти на главную страницу справки</a></small></nav>

        <a href="#" id="back-to-top"><img src="../img/backtotop.png" alt="Наверх" /></a>
        <!--Smooth Back to Top Button End-->

        <h1>Менеджер отчётов</h1>
    </header>

    <!-- ToC generated by Javascript -->
    <nav id="toc"></nav>

    <h2>Открытие менеджера отчетов</h2>
    <p>Нажмите иконку "Менеджер отчетов" или в главном меню Инструменты Менеджер отчетов...</p>
    <img class="shadow" alt="Панель GRM" src="../en/grm_toolbar.png">

    <h2>Создание нового отчета</h2>
    <p>Есть 2 варианта.</p>

    <h3>Создание отчёта с нуля</h3>
    <ol>
        <li>В дереве навигации, щелкните правой кнопкой мыши на корневом элементе "Отчёты".</li>
        <li>Выберите пункт меню: "Новый пустой отчет".</li>
        <li>Введите имя группы отчетов и новое имя самого отчёта.</li>
        <li>Переименуйте отчет, если это необходимо, щелкнув правой кнопкой мыши по пункту меню: "Переименовать отчёт".</li>
        <li>Будет показано три вкладки: SQL, Lua и htt.</li>
        <li>
            Выберите вкладку: SQL, вставьте скрипт SQL в окно редактора, проверьте, что скрипт SQL завершается точкой с запятой, затем нажмите кнопку "Сохранить".
        </li>
        <li>Нажмите кнопку "Тест" для выполнения скрипта SQL.</li>
        <li>Если тест пройден, кнопка "Создать шаблон" станет доступной.
            Нажмите на него, чтобы создать шаблон html для отчета.</li>
        <li>Нажмите кнопку 'Запуск', чтобы получить html отчет в окне вывода.</li>
    </ol>
    <img class="shadow" alt="GRM" src="../en/grm.gif">

    <h4>Параметры отчёта</h4>

    <p>Для mmex вер. 1.4.0 существует возможность передачи дат в SQL скрипт отчета.
    Есть четыре варианта: <var>&single_date</var>, <var>&begin_date</var>, <var>&end_date</var>, <var>&budget_years</var>.
    В случае если SQL содержит один из вышеуказанных параметров, он будет заменен датой из виджета.
    Например, этот SQL скрипт возвращает все балансы счетов за указанную дату:
    </p>

<pre><code>
with b as  (
    select ACCOUNTID, STATUS
        , (case when TRANSCODE = 'Deposit' then TRANSAMOUNT else -TRANSAMOUNT end) as TRANSAMOUNT
        , TRANSDATE
    from CHECKINGACCOUNT
    union all
    select TOACCOUNTID, STATUS, TOTRANSAMOUNT ,TRANSDATE
    from CHECKINGACCOUNT
    where TRANSCODE = 'Transfer'
    )
select a.ACCOUNTNAME,
total(TRANSAMOUNT) + a.INITIALBAL as Balance
from ACCOUNTLIST as a, b
where a.STATUS = 'Open'
    and b.ACCOUNTID = a.ACCOUNTID
    and b.STATUS &lt;&gt; 'V'
    and b.TRANSDATE &lt;= '<var>&single_date</var>'
group by a.ACCOUNTNAME order by a.ACCOUNTNAME asc;
</code></pre>

    <img class="shadow" alt="Дата GRM" src="../ru/grm_custom_date.png">

    <h3>Импорт отчёта</h3>
    <p>
        Есть много отчетов, представленных пользователями или разработчиками на
    </p>
        <a href="https://github.com/moneymanagerex/general-reports/releases">github</a>

    <h2>Экспорт отчета</h2>
    <p>Если вы создали любой полезный отчет, он может быть
    <a href="http://forum.moneymanagerex.org/viewforum.php?f=16">экспортирован в zip-файл</a>.</p>

    <footer><p><small>
        Copyright &copy; 2005-2009 Madhan Kanagavel<br>
        Copyright &copy; 2013-2019 MMEX contributors<br>
        <span id="translator">Перевод: Николай Акимов</span>
    </small></p></footer>
    <script>
        var LANG = document.getElementsByTagName('html')[0].getAttribute('lang');
        var tr = document.getElementById("translator");
        if (LANG == 'en')
            tr.parentNode.removeChild(tr);
    </script>

</body>
</html>
